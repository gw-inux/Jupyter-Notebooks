<!DOCTYPE html>
        <html lang="en">
            <head>
                <meta charset="utf-8">
                <link rel="icon" href="https://aquainsight.sharepoint.com/sites/AquaInsight/_api/siteiconmanager/getsitelogo?type=%271%27&hash=637675014792340093">
                <title>Well Capture</title>
                
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-3.4.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.4.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.4.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.4.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-3.4.1.min.js"></script>
    <script type="text/javascript">
        Bokeh.set_log_level("info");
    </script>

<script type='text/javascript' src="http://d3js.org/d3.v6.js"></script>
                    <script type="text/javascript">
        (function() {
  const fn = function() {
    Bokeh.safely(function() {
      (function(root) {
        function embed_document(root) {
        const docs_json = '{"95c5ad28-2141-4989-a75a-298eaedc7b26":{"version":"3.4.1","title":"Bokeh Application","roots":[{"type":"object","name":"Column","id":"p3990","attributes":{"sizing_mode":"scale_width","children":[{"type":"object","name":"Row","id":"p3985","attributes":{"sizing_mode":"scale_width","children":[{"type":"object","name":"Slider","id":"p3836","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"type":"object","name":"CustomJS","id":"p3969","attributes":{"args":{"type":"map","entries":[["src",{"type":"object","name":"ColumnDataSource","id":"p3895","attributes":{"selected":{"type":"object","name":"Selection","id":"p3896","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p3897"},"data":{"type":"map","entries":[["y",[]],["x",[]]]}}}],["sl_dict",{"type":"map","entries":[["Pumping",{"id":"p3836"}],["Thickness",{"type":"object","name":"Slider","id":"p3837","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3969"},{"type":"object","name":"CustomJS","id":"p3975","attributes":{"args":{"type":"map","entries":[["ccb",{"type":"object","name":"CustomJS","id":"p3974","attributes":{"args":{"type":"map","entries":[["ni",{"type":"object","name":"NumericInput","id":"p3973","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3975"}]]]},"width":100,"value":20,"low":1,"high":100,"mode":"float"}}],["sl",{"id":"p3837"}],["log",false]]},"code":"\\n                    sl.tags=[]\\n                    ni.tags=[]\\n                                        \\n                    if (cb_obj === sl){\\n                            if (log == true){\\n                                 ni.value = 10**sl.value\\n                                    }\\n                            else {\\n                                ni.value = sl.value\\n                                }\\n                            }\\n                    else {\\n                        // if ni, need to find nearest slider value\\n                        if (log == true){\\n                                var v = Math.log10(ni.value)\\n                                }\\n                        else {\\n                            var v = ni.value\\n                            }\\n                        //value input is less than slider start\\n                        if (v&lt;=sl.start){\\n                                if (log == true){\\n                                     sl.value = sl.start\\n                                     ni.value = 10**sl.start\\n                                        }\\n                                else {\\n                                    sl.value = sl.start\\n                                    ni.value = sl.start\\n                                    }\\n                                }\\n                        //value is more than slider end\\n                        else if (v&gt;=sl.end){\\n                                if (log == true){\\n                                     sl.value = sl.end\\n                                     ni.value = 10**sl.end\\n                                        }\\n                                else {\\n                                    sl.value = sl.end\\n                                    ni.value = sl.end\\n                                    }\\n                            }\\n                        \\n                        else {\\n                            var i = 1\\n                            do {\\n                                if (v&lt;sl.start+sl.step*i){\\n                                        //value is now between current notch and previous\\n                                        if (log==true){\\n                                            var dl = Math.log10(ni.value)-(sl.start+sl.step*(i-1))\\n                                            var dr = (sl.start+(sl.step*i))-Math.log(ni.value)\\n                                            }\\n                                        else {\\n                                            var dl = ni.value-(sl.start+sl.step*(i-1))\\n                                            var dr = (sl.start+(sl.step*i))-ni.value\\n                                            }\\n                                        if (dl&lt;=dr){\\n                                                var v = sl.start+sl.step*(i-1)\\n                                                }\\n                                        else {\\n                                            var v = sl.start+sl.step*i\\n                                            }\\n                                        sl.value = v\\n                                        if (log==true){\\n                                                ni.value = 10**v\\n                                                }\\n                                        else {\\n                                            ni.value = v\\n                                            }\\n                                        break\\n                                        }\\n                                i++\\n                                } while (true)\\n                            }\\n                        }\\n                    "}}],["sl",{"id":"p3837"}],["ni",{"id":"p3973"}]]},"code":"\\n\\n                  if (cb_obj.tags.length&gt;0){\\n                          return\\n                          }\\n                  else {\\n                      sl.tags = [&#x27;run_me&#x27;]\\n                      ni.tags = [&#x27;run_me&#x27;]\\n                      ccb.execute(cb_obj)\\n                      sl.tags = [&#x27;run_me&#x27;]\\n                      ni.tags = [&#x27;run_me&#x27;]\\n                      }\\n                  "}}]]]},"stylesheets":[{"type":"object","name":"InlineStyleSheet","id":"p3835","attributes":{"css":"div.bk-btn-group button{\\n\\tfont-family: arial;\\n    color: #17648D;\\n    font-weight: bold;\\n\\tfont-size: min(5vw, 18px);\\n}\\ndiv.bk-slider-title{\\n                font-family: arial;\\n                font-weight: bold;\\n                font-size: min(5vw, 18px);\\n                color: #17648D;\\n}\\n\\n\\n\\n"}}],"width":1200,"sizing_mode":"stretch_width","title":"Aquifer thickness (m)","format":"0.00","start":1,"end":100,"value":20,"step":0.01}}],["Gradient",{"type":"object","name":"Slider","id":"p3839","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3969"},{"type":"object","name":"CustomJS","id":"p3978","attributes":{"args":{"type":"map","entries":[["ccb",{"type":"object","name":"CustomJS","id":"p3977","attributes":{"args":{"type":"map","entries":[["ni",{"type":"object","name":"NumericInput","id":"p3976","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3978"}]]]},"width":100,"value":1e-05,"low":1e-05,"high":1,"mode":"float"}}],["sl",{"id":"p3839"}],["log",true]]},"code":"\\n                    sl.tags=[]\\n                    ni.tags=[]\\n                                        \\n                    if (cb_obj === sl){\\n                            if (log == true){\\n                                 ni.value = 10**sl.value\\n                                    }\\n                            else {\\n                                ni.value = sl.value\\n                                }\\n                            }\\n                    else {\\n                        // if ni, need to find nearest slider value\\n                        if (log == true){\\n                                var v = Math.log10(ni.value)\\n                                }\\n                        else {\\n                            var v = ni.value\\n                            }\\n                        //value input is less than slider start\\n                        if (v&lt;=sl.start){\\n                                if (log == true){\\n                                     sl.value = sl.start\\n                                     ni.value = 10**sl.start\\n                                        }\\n                                else {\\n                                    sl.value = sl.start\\n                                    ni.value = sl.start\\n                                    }\\n                                }\\n                        //value is more than slider end\\n                        else if (v&gt;=sl.end){\\n                                if (log == true){\\n                                     sl.value = sl.end\\n                                     ni.value = 10**sl.end\\n                                        }\\n                                else {\\n                                    sl.value = sl.end\\n                                    ni.value = sl.end\\n                                    }\\n                            }\\n                        \\n                        else {\\n                            var i = 1\\n                            do {\\n                                if (v&lt;sl.start+sl.step*i){\\n                                        //value is now between current notch and previous\\n                                        if (log==true){\\n                                            var dl = Math.log10(ni.value)-(sl.start+sl.step*(i-1))\\n                                            var dr = (sl.start+(sl.step*i))-Math.log(ni.value)\\n                                            }\\n                                        else {\\n                                            var dl = ni.value-(sl.start+sl.step*(i-1))\\n                                            var dr = (sl.start+(sl.step*i))-ni.value\\n                                            }\\n                                        if (dl&lt;=dr){\\n                                                var v = sl.start+sl.step*(i-1)\\n                                                }\\n                                        else {\\n                                            var v = sl.start+sl.step*i\\n                                            }\\n                                        sl.value = v\\n                                        if (log==true){\\n                                                ni.value = 10**v\\n                                                }\\n                                        else {\\n                                            ni.value = v\\n                                            }\\n                                        break\\n                                        }\\n                                i++\\n                                } while (true)\\n                            }\\n                        }\\n                    "}}],["sl",{"id":"p3839"}],["ni",{"id":"p3976"}]]},"code":"\\n\\n                  if (cb_obj.tags.length&gt;0){\\n                          return\\n                          }\\n                  else {\\n                      sl.tags = [&#x27;run_me&#x27;]\\n                      ni.tags = [&#x27;run_me&#x27;]\\n                      ccb.execute(cb_obj)\\n                      sl.tags = [&#x27;run_me&#x27;]\\n                      ni.tags = [&#x27;run_me&#x27;]\\n                      }\\n                  "}}]]]},"stylesheets":[{"id":"p3835"}],"width":1200,"sizing_mode":"stretch_width","title":"Gradient of regional flow (dimensionless)","format":{"type":"object","name":"CustomJSTickFormatter","id":"p3838","attributes":{"code":"return (10**tick).toExponential(2).toString()"}},"start":-5,"end":0,"value":-5,"step":0.1}}],["Conductivity",{"type":"object","name":"Slider","id":"p3841","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3969"},{"type":"object","name":"CustomJS","id":"p3981","attributes":{"args":{"type":"map","entries":[["ccb",{"type":"object","name":"CustomJS","id":"p3980","attributes":{"args":{"type":"map","entries":[["ni",{"type":"object","name":"NumericInput","id":"p3979","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3981"}]]]},"width":100,"value":0.001,"low":1e-07,"high":1,"mode":"float"}}],["sl",{"id":"p3841"}],["log",true]]},"code":"\\n                    sl.tags=[]\\n                    ni.tags=[]\\n                                        \\n                    if (cb_obj === sl){\\n                            if (log == true){\\n                                 ni.value = 10**sl.value\\n                                    }\\n                            else {\\n                                ni.value = sl.value\\n                                }\\n                            }\\n                    else {\\n                        // if ni, need to find nearest slider value\\n                        if (log == true){\\n                                var v = Math.log10(ni.value)\\n                                }\\n                        else {\\n                            var v = ni.value\\n                            }\\n                        //value input is less than slider start\\n                        if (v&lt;=sl.start){\\n                                if (log == true){\\n                                     sl.value = sl.start\\n                                     ni.value = 10**sl.start\\n                                        }\\n                                else {\\n                                    sl.value = sl.start\\n                                    ni.value = sl.start\\n                                    }\\n                                }\\n                        //value is more than slider end\\n                        else if (v&gt;=sl.end){\\n                                if (log == true){\\n                                     sl.value = sl.end\\n                                     ni.value = 10**sl.end\\n                                        }\\n                                else {\\n                                    sl.value = sl.end\\n                                    ni.value = sl.end\\n                                    }\\n                            }\\n                        \\n                        else {\\n                            var i = 1\\n                            do {\\n                                if (v&lt;sl.start+sl.step*i){\\n                                        //value is now between current notch and previous\\n                                        if (log==true){\\n                                            var dl = Math.log10(ni.value)-(sl.start+sl.step*(i-1))\\n                                            var dr = (sl.start+(sl.step*i))-Math.log(ni.value)\\n                                            }\\n                                        else {\\n                                            var dl = ni.value-(sl.start+sl.step*(i-1))\\n                                            var dr = (sl.start+(sl.step*i))-ni.value\\n                                            }\\n                                        if (dl&lt;=dr){\\n                                                var v = sl.start+sl.step*(i-1)\\n                                                }\\n                                        else {\\n                                            var v = sl.start+sl.step*i\\n                                            }\\n                                        sl.value = v\\n                                        if (log==true){\\n                                                ni.value = 10**v\\n                                                }\\n                                        else {\\n                                            ni.value = v\\n                                            }\\n                                        break\\n                                        }\\n                                i++\\n                                } while (true)\\n                            }\\n                        }\\n                    "}}],["sl",{"id":"p3841"}],["ni",{"id":"p3979"}]]},"code":"\\n\\n                  if (cb_obj.tags.length&gt;0){\\n                          return\\n                          }\\n                  else {\\n                      sl.tags = [&#x27;run_me&#x27;]\\n                      ni.tags = [&#x27;run_me&#x27;]\\n                      ccb.execute(cb_obj)\\n                      sl.tags = [&#x27;run_me&#x27;]\\n                      ni.tags = [&#x27;run_me&#x27;]\\n                      }\\n                  "}}]]]},"stylesheets":[{"id":"p3835"}],"width":1200,"sizing_mode":"stretch_width","title":"Hydraulic Conductivity (m/s)","format":{"type":"object","name":"CustomJSTickFormatter","id":"p3840","attributes":{"code":"return (10**tick).toExponential(2).toString()"}},"start":-7,"end":0,"value":-3,"step":0.01}}],["Porosity",{"type":"object","name":"Slider","id":"p3842","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3969"},{"type":"object","name":"CustomJS","id":"p3984","attributes":{"args":{"type":"map","entries":[["ccb",{"type":"object","name":"CustomJS","id":"p3983","attributes":{"args":{"type":"map","entries":[["ni",{"type":"object","name":"NumericInput","id":"p3982","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3984"}]]]},"width":100,"value":0.3,"low":0.01,"high":0.5,"mode":"float"}}],["sl",{"id":"p3842"}],["log",false]]},"code":"\\n                    sl.tags=[]\\n                    ni.tags=[]\\n                                        \\n                    if (cb_obj === sl){\\n                            if (log == true){\\n                                 ni.value = 10**sl.value\\n                                    }\\n                            else {\\n                                ni.value = sl.value\\n                                }\\n                            }\\n                    else {\\n                        // if ni, need to find nearest slider value\\n                        if (log == true){\\n                                var v = Math.log10(ni.value)\\n                                }\\n                        else {\\n                            var v = ni.value\\n                            }\\n                        //value input is less than slider start\\n                        if (v&lt;=sl.start){\\n                                if (log == true){\\n                                     sl.value = sl.start\\n                                     ni.value = 10**sl.start\\n                                        }\\n                                else {\\n                                    sl.value = sl.start\\n                                    ni.value = sl.start\\n                                    }\\n                                }\\n                        //value is more than slider end\\n                        else if (v&gt;=sl.end){\\n                                if (log == true){\\n                                     sl.value = sl.end\\n                                     ni.value = 10**sl.end\\n                                        }\\n                                else {\\n                                    sl.value = sl.end\\n                                    ni.value = sl.end\\n                                    }\\n                            }\\n                        \\n                        else {\\n                            var i = 1\\n                            do {\\n                                if (v&lt;sl.start+sl.step*i){\\n                                        //value is now between current notch and previous\\n                                        if (log==true){\\n                                            var dl = Math.log10(ni.value)-(sl.start+sl.step*(i-1))\\n                                            var dr = (sl.start+(sl.step*i))-Math.log(ni.value)\\n                                            }\\n                                        else {\\n                                            var dl = ni.value-(sl.start+sl.step*(i-1))\\n                                            var dr = (sl.start+(sl.step*i))-ni.value\\n                                            }\\n                                        if (dl&lt;=dr){\\n                                                var v = sl.start+sl.step*(i-1)\\n                                                }\\n                                        else {\\n                                            var v = sl.start+sl.step*i\\n                                            }\\n                                        sl.value = v\\n                                        if (log==true){\\n                                                ni.value = 10**v\\n                                                }\\n                                        else {\\n                                            ni.value = v\\n                                            }\\n                                        break\\n                                        }\\n                                i++\\n                                } while (true)\\n                            }\\n                        }\\n                    "}}],["sl",{"id":"p3842"}],["ni",{"id":"p3982"}]]},"code":"\\n\\n                  if (cb_obj.tags.length&gt;0){\\n                          return\\n                          }\\n                  else {\\n                      sl.tags = [&#x27;run_me&#x27;]\\n                      ni.tags = [&#x27;run_me&#x27;]\\n                      ccb.execute(cb_obj)\\n                      sl.tags = [&#x27;run_me&#x27;]\\n                      ni.tags = [&#x27;run_me&#x27;]\\n                      }\\n                  "}}]]]},"stylesheets":[{"id":"p3835"}],"width":1200,"sizing_mode":"stretch_width","title":"Porosity","start":0.01,"end":0.5,"value":0.3,"step":0.01}}]]}],["f",{"type":"object","name":"Figure","id":"p3843","attributes":{"js_event_callbacks":{"type":"map","entries":[["tap",[{"type":"object","name":"CustomJS","id":"p3968","attributes":{"args":{"type":"map","entries":[["sl_dict",{"type":"map","entries":[["Pumping",{"id":"p3836"}],["Thickness",{"id":"p3837"}],["Gradient",{"id":"p3839"}],["Conductivity",{"id":"p3841"}],["Porosity",{"id":"p3842"}]]}],["pt_src",{"type":"object","name":"ColumnDataSource","id":"p3943","attributes":{"selected":{"type":"object","name":"Selection","id":"p3944","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p3945"},"data":{"type":"map","entries":[["x",[]],["y",[]]]}}}],["f",{"id":"p3843"}],["pt_d",{"type":"object","name":"PointDrawTool","id":"p3952","attributes":{"renderers":[{"type":"object","name":"GlyphRenderer","id":"p3949","attributes":{"data_source":{"id":"p3943"},"view":{"type":"object","name":"CDSView","id":"p3950","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p3951"}}},"glyph":{"type":"object","name":"Scatter","id":"p3946","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"size":{"type":"value","value":5},"line_color":{"type":"value","value":"#1f77b4"},"fill_color":{"type":"value","value":"#1f77b4"}}},"nonselection_glyph":{"type":"object","name":"Scatter","id":"p3947","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"size":{"type":"value","value":5},"line_color":{"type":"value","value":"#1f77b4"},"line_alpha":{"type":"value","value":0.1},"fill_color":{"type":"value","value":"#1f77b4"},"fill_alpha":{"type":"value","value":0.1},"hatch_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"Scatter","id":"p3948","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"size":{"type":"value","value":5},"line_color":{"type":"value","value":"#1f77b4"},"line_alpha":{"type":"value","value":0.2},"fill_color":{"type":"value","value":"#1f77b4"},"fill_alpha":{"type":"value","value":0.2},"hatch_alpha":{"type":"value","value":0.2}}}}}],"num_objects":1}}],["ptl_src",{"type":"object","name":"ColumnDataSource","id":"p3953","attributes":{"selected":{"type":"object","name":"Selection","id":"p3954","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p3955"},"data":{"type":"map","entries":[["x",[]],["y",[]]]}}}]]},"code":"\\nimport * as d3 from \\"https://cdn.jsdelivr.net/npm/d3@7.9/+esm\\"\\nimport * as d3Contour from &#x27;https://cdn.jsdelivr.net/npm/d3-contour@4.0.2/+esm&#x27;\\n\\n// js function equivalent to np.linspace\\nfunction makeArr(startValue, stopValue, cardinality) {\\n  var arr = [];\\n  var step = (stopValue - startValue) / (cardinality - 1);\\n  for (var i = 0; i &lt; cardinality; i++) {\\n\\tarr.push(startValue + (step * i));\\n  }\\n  return arr;\\n}\\n\\n//transforms columndatasource data to array of objects\\nfunction cds_to_objarray(cds_data){\\n  var keys = Object.keys(cds_data)\\n  var z = d3.transpose(Object.values(cds_data))\\n  var o = z.map(x=&gt;Object.assign(...keys.map((k, i) =&gt; ({[k]: x[i]}))))\\n  return o}\\n  \\n//transforms array of objects to columndatasource \\"dictionary\\"/object \\nfunction objarray_to_cds(objarray){\\n  var a = d3.transpose(objarray.map(x=&gt;Object.values(x)))\\n  if (a.length&gt;0){\\n    var d = Object.assign(...Object.keys(objarray[0]).map((k, i) =&gt; ({[k]: a[i]})))\\n    }\\n  return d\\n  }\\n  \\n//translates a d3 contour result into multiline-ready CDS data\\nfunction contours_to_cds(d3_contour){\\n    var cxs = []\\n    var cys = []\\n    var cv = []\\n    for (var vi=0;vi&lt;d3_contour.length;vi++){                       \\n     \\t\\t   for (var pi=0; pi&lt;d3_contour[vi].coordinates.length;pi++){\\n     \\t\\t\\t  for (var ppi = 0; ppi&lt;d3_contour[vi].coordinates[pi].length;ppi++){                                  \\n     \\t\\t\\t\\t\\t  var xy = d3.transpose(d3_contour[vi].coordinates[pi][ppi])\\n     \\t\\t\\t\\t\\t  cxs.push(xy[0])\\n     \\t\\t\\t\\t\\t  cys.push(xy[1])\\n     \\t\\t\\t\\t\\t  cv.push(d3_contour[vi].value)\\n     \\t\\t\\t\\t\\t  }\\n     \\t\\t\\t\\t\\t  }\\n     \\t\\t\\t\\t   }\\n    return {&#x27;z&#x27;:cv,&#x27;xs&#x27;:cxs,&#x27;ys&#x27;:cys}\\n    }\\n\\nexport default function({sl_dict,pt_src, f, pt_d, ptl_src\\n                        }){\\n    if (pt_d.active == true){\\n    \\t//collect slider values\\n    \\tvar q = sl_dict[&#x27;Pumping&#x27;].value/10**9 //cubic km/s \\n    \\tvar k = 10**sl_dict[&#x27;Conductivity&#x27;].value/1000 //km/s\\n    \\tvar i = 10**sl_dict[&#x27;Gradient&#x27;].value\\n    \\tvar b = sl_dict[&#x27;Thickness&#x27;].value/1000 //km\\n    \\tvar por = sl_dict[&#x27;Porosity&#x27;].value //porosity\\n    \\t\\n\\n        function calcVx(x,y,i,q,b,k,n){\\n            var gr = i-(q*x)/(2*Math.PI*b*k*(x**2+y**2))\\n            return gr*k/n\\n            }\\n        function calcVy(x,y,q,b,k,n){\\n            var gr = -(q*y)/(2*Math.PI*b*k*(x**2+y**2))\\n            return gr*k/n\\n            }\\n        function calcH(x,y,i,q,b,k){\\n            var rgt = -i*(x-1000) \\n            var wt = q/(2*Math.PI*b*k)*Math.log((x**2+y**2)**0.5/1000)\\n            return {&#x27;rgt&#x27;:rgt,&#x27;wt&#x27;:wt, &#x27;h&#x27;:rgt+wt}\\n            }\\n        \\n        var xi = pt_src.data[&#x27;x&#x27;][0]\\n        var yi = pt_src.data[&#x27;y&#x27;][0]\\n\\n        var vx = calcVx(xi,yi,i,q,b,k,por)\\n        var vy = calcVy(xi,yi,q,b,k,por)\\n        var v = (vx**2+vy**2)**0.5\\n        var xr = f.x_range.end-f.x_range.start\\n        var yr = f.y_range.end-f.y_range.start\\n        var fr = d3.max([xr,yr])\\n        var td = fr/1000/v //initial time step\\n        \\n        //initialize results arrays\\n        var vxa = [vx]\\n        var vya = [vy]\\n        var ta = [0]\\n        var xa = [xi]\\n        var ya = [yi]\\n        var ha = [calcH(xi,yi,i,q,b,k)[&#x27;h&#x27;]*1000]\\n        var xn = xi+vx*td\\n        var yn = yi+vy*td\\n        do {\\n            var hn = calcH(xn,yn,i,q,b,k)[&#x27;h&#x27;]*1000\\n            \\n            //termination criteria one, next head is higher than current\\n            if (hn&gt;ha[ha.length-1]){\\n                break\\n                }\\n                \\n            xa.push(xn)\\n            ya.push(yn)\\n            ta.push(td)\\n            vx = calcVx(xn,yn,i,q,b,k,por)\\n            vy = calcVy(xn,yn,q,b,k,por)\\n            vxa.push(vx)\\n            vya.push(vy)\\n            \\n            \\n\\n            \\n            ha.push(hn)\\n            v = (vx**2+vy**2)**0.5\\n            td = fr/1000/v\\n\\n            xn = xn+vx*td\\n            yn = yn+vy*td\\n            //termination criteria two --&gt; reaches the far field\\n            if (xn &gt; 1000){\\n                break\\n                }\\n               // }\\n            } while (xa.length&lt;1001)\\n       ptl_src.data = {&#x27;x&#x27;:xa,&#x27;y&#x27;:ya,&#x27;t&#x27;:d3.cumsum(ta).map(x=&gt;x/60/60/24/365)}\\n        }\\n\\t    \\t\\n}","module":true}}]]]},"width":1200,"height":800,"x_range":{"type":"object","name":"Range1d","id":"p3852","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:start",[{"type":"object","name":"CustomJS","id":"p3993","attributes":{"args":{"type":"map","entries":[["fmt_oa",[{"type":"map","entries":[["minRange",0],["unitName","Meters"],["scaleFactor",0.001]]},{"type":"map","entries":[["minRange",3],["unitName","Kilometers"],["scaleFactor",1.0]]}]],["m",[{"type":"map","entries":[["range",{"id":"p3852"}],["ax",{"type":"object","name":"LinearAxis","id":"p3856","attributes":{"ticker":{"type":"object","name":"FixedTicker","id":"p3991","attributes":{"ticks":[],"minor_ticks":[]}},"formatter":{"type":"object","name":"CustomJSTickFormatter","id":"p3994","attributes":{"args":{"type":"map","entries":[["fmt_oa",[{"type":"map","entries":[["minRange",0],["unitName","Meters"],["scaleFactor",0.001]]},{"type":"map","entries":[["minRange",3],["unitName","Kilometers"],["scaleFactor",1.0]]}]],["rng",{"id":"p3852"}]]},"code":"\\n                                    var d = rng.end-rng.start\\n                                    for (var i = 0; i &lt; fmt_oa.length-1; i++){\\n                                            if (d&gt;=fmt_oa[i][&#x27;minRange&#x27;] &amp;&amp; d &lt; fmt_oa[i+1][&#x27;minRange&#x27;]){\\n                                                    var sel = fmt_oa[i]                                                    \\n                                                    break\\n                                                    }\\n                                            }\\n                                    if (i == fmt_oa.length-1){\\n                                            var sel = fmt_oa[i]                                            \\n                                            }\\n                                    return tick/sel[&#x27;scaleFactor&#x27;]\\n                                    "}},"axis_label":"Kilometers","axis_label_text_color":"#17648D","axis_label_text_font":"arial","axis_label_text_font_size":"18px","axis_label_text_font_style":"bold","major_label_policy":{"type":"object","name":"AllLabels","id":"p3859"},"major_label_text_font":"arial","major_label_text_font_size":"16px","major_label_text_font_style":"normal"}}],["tks",{"id":"p3991"}]]},{"type":"map","entries":[["range",{"type":"object","name":"Range1d","id":"p3853","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:start",[{"id":"p3993"}]],["change:end",[{"id":"p3993"}]]]},"start":-5,"end":5}}],["ax",{"type":"object","name":"LinearAxis","id":"p3861","attributes":{"ticker":{"type":"object","name":"FixedTicker","id":"p3992","attributes":{"ticks":[],"minor_ticks":[]}},"formatter":{"type":"object","name":"CustomJSTickFormatter","id":"p3995","attributes":{"args":{"type":"map","entries":[["fmt_oa",[{"type":"map","entries":[["minRange",0],["unitName","Meters"],["scaleFactor",0.001]]},{"type":"map","entries":[["minRange",3],["unitName","Kilometers"],["scaleFactor",1.0]]}]],["rng",{"id":"p3853"}]]},"code":"\\n                                    var d = rng.end-rng.start\\n                                    for (var i = 0; i &lt; fmt_oa.length-1; i++){\\n                                            if (d&gt;=fmt_oa[i][&#x27;minRange&#x27;] &amp;&amp; d &lt; fmt_oa[i+1][&#x27;minRange&#x27;]){\\n                                                    var sel = fmt_oa[i]                                                    \\n                                                    break\\n                                                    }\\n                                            }\\n                                    if (i == fmt_oa.length-1){\\n                                            var sel = fmt_oa[i]                                            \\n                                            }\\n                                    return tick/sel[&#x27;scaleFactor&#x27;]\\n                                    "}},"axis_label":"Kilometers","axis_label_text_color":"#17648D","axis_label_text_font":"arial","axis_label_text_font_size":"18px","axis_label_text_font_style":"bold","major_label_policy":{"type":"object","name":"AllLabels","id":"p3864"},"major_label_text_font":"arial","major_label_text_font_size":"16px","major_label_text_font_style":"normal"}}],["tks",{"id":"p3992"}]]}]]]},"code":"\\n                                for (var ri = 0; ri &lt; m.length; ri++){ \\n                                        var xr = m[ri][&#x27;range&#x27;] \\n                                        var d = xr.end - xr.start\\n                                        for (var i = 0; i &lt; fmt_oa.length-1; i++){\\n                                                if (d&gt;=fmt_oa[i][&#x27;minRange&#x27;] &amp;&amp; d &lt; fmt_oa[i+1][&#x27;minRange&#x27;]){\\n                                                        var sel = fmt_oa[i]                                                    \\n                                                        break\\n                                                        }\\n                                                }\\n                                        if (i == fmt_oa.length-1){\\n                                                var sel = fmt_oa[i]                                            \\n                                                }\\n                                        var tks = d3.ticks(xr.start/sel[&#x27;scaleFactor&#x27;]\\n                                                           ,xr.end/sel[&#x27;scaleFactor&#x27;],6)\\n                                        var upd_tks = tks.map(x=&gt;x*sel[&#x27;scaleFactor&#x27;])\\n                                        m[ri][&#x27;tks&#x27;].ticks = upd_tks\\n                                        m[ri][&#x27;ax&#x27;].axis_label = sel[&#x27;unitName&#x27;]\\n                                        }\\n                                "}}]],["change:end",[{"id":"p3993"}]]]},"start":-10}},"y_range":{"id":"p3853"},"x_scale":{"type":"object","name":"LinearScale","id":"p3854"},"y_scale":{"type":"object","name":"LinearScale","id":"p3855"},"title":{"type":"object","name":"Title","id":"p3850","attributes":{"text_color":"#17648D","text_font":"arial","text_font_size":"20px"}},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p3890","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p3884","attributes":{"selected":{"type":"object","name":"Selection","id":"p3885","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p3886"},"data":{"type":"map","entries":[["x",[0]],["y",[0]]]}}},"view":{"type":"object","name":"CDSView","id":"p3891","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p3892"}}},"glyph":{"type":"object","name":"Scatter","id":"p3887","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"size":{"type":"value","value":12},"line_color":{"type":"value","value":"#1f77b4"},"fill_color":{"type":"value","value":"red"},"marker":{"type":"value","value":"circle_x"}}},"nonselection_glyph":{"type":"object","name":"Scatter","id":"p3888","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"size":{"type":"value","value":12},"line_color":{"type":"value","value":"#1f77b4"},"line_alpha":{"type":"value","value":0.1},"fill_color":{"type":"value","value":"red"},"fill_alpha":{"type":"value","value":0.1},"hatch_alpha":{"type":"value","value":0.1},"marker":{"type":"value","value":"circle_x"}}},"muted_glyph":{"type":"object","name":"Scatter","id":"p3889","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"size":{"type":"value","value":12},"line_color":{"type":"value","value":"#1f77b4"},"line_alpha":{"type":"value","value":0.2},"fill_color":{"type":"value","value":"red"},"fill_alpha":{"type":"value","value":0.2},"hatch_alpha":{"type":"value","value":0.2},"marker":{"type":"value","value":"circle_x"}}}}},{"type":"object","name":"GlyphRenderer","id":"p3904","attributes":{"data_source":{"id":"p3895"},"view":{"type":"object","name":"CDSView","id":"p3905","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p3906"}}},"glyph":{"type":"object","name":"Patch","id":"p3901","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#1f77b4","fill_color":"#1f77b4","fill_alpha":0.1}},"nonselection_glyph":{"type":"object","name":"Patch","id":"p3902","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#1f77b4","line_alpha":0.1,"fill_color":"#1f77b4","fill_alpha":0.1,"hatch_alpha":0.1}},"muted_glyph":{"type":"object","name":"Patch","id":"p3903","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#1f77b4","line_alpha":0.2,"fill_color":"#1f77b4","fill_alpha":0.2,"hatch_alpha":0.2}}}},{"type":"object","name":"GlyphRenderer","id":"p3938","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p3928","attributes":{"selected":{"type":"object","name":"Selection","id":"p3929","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p3930"},"data":{"type":"map","entries":[["xs",[]],["ys",[]],["z",[]]]}}},"view":{"type":"object","name":"CDSView","id":"p3939","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p3940"}}},"glyph":{"type":"object","name":"MultiLine","id":"p3935","attributes":{"xs":{"type":"field","field":"xs"},"ys":{"type":"field","field":"ys"},"line_color":{"type":"field","field":"z","transform":{"type":"object","name":"LinearColorMapper","id":"p3931","attributes":{"palette":["#30123b","#311542","#32184a","#341b51","#351e58","#36215f","#372365","#38266c","#392972","#3a2c79","#3b2f7f","#3c3285","#3c358b","#3d3791","#3e3a96","#3f3d9c","#4040a1","#4043a6","#4145ab","#4148b0","#424bb5","#434eba","#4350be","#4353c2","#4456c7","#4458cb","#455bce","#455ed2","#4560d6","#4563d9","#4666dd","#4668e0","#466be3","#466de6","#4670e8","#4673eb","#4675ed","#4678f0","#467af2","#467df4","#467ff6","#4682f8","#4584f9","#4587fb","#4589fc","#448cfd","#438efd","#4291fe","#4193fe","#4096fe","#3f98fe","#3e9bfe","#3c9dfd","#3ba0fc","#39a2fc","#38a5fb","#36a8f9","#34aaf8","#33acf6","#31aff5","#2fb1f3","#2db4f1","#2bb6ef","#2ab9ed","#28bbeb","#26bde9","#25c0e6","#23c2e4","#21c4e1","#20c6df","#1ec9dc","#1dcbda","#1ccdd7","#1bcfd4","#1ad1d2","#19d3cf","#18d5cc","#18d7ca","#17d9c7","#17dac4","#17dcc2","#17debf","#18e0bd","#18e1ba","#19e3b8","#1ae4b6","#1be5b4","#1de7b1","#1ee8af","#20e9ac","#22eba9","#24eca6","#27eda3","#29eea0","#2cef9d","#2ff09a","#32f197","#35f394","#38f491","#3bf48d","#3ff58a","#42f687","#46f783","#4af880","#4df97c","#51f979","#55fa76","#59fb72","#5dfb6f","#61fc6c","#65fc68","#69fd65","#6dfd62","#71fd5f","#74fe5c","#78fe59","#7cfe56","#80fe53","#84fe50","#87fe4d","#8bfe4b","#8efe48","#92fe46","#95fe44","#98fe42","#9bfd40","#9efd3e","#a1fc3d","#a4fc3b","#a6fb3a","#a9fb39","#acfa37","#aef937","#b1f836","#b3f835","#b6f735","#b9f534","#bbf434","#bef334","#c0f233","#c3f133","#c5ef33","#c8ee33","#caed33","#cdeb34","#cfea34","#d1e834","#d4e735","#d6e535","#d8e335","#dae236","#dde036","#dfde36","#e1dc37","#e3da37","#e5d838","#e7d738","#e8d538","#ead339","#ecd139","#edcf39","#efcd39","#f0cb3a","#f2c83a","#f3c63a","#f4c43a","#f6c23a","#f7c039","#f8be39","#f9bc39","#f9ba38","#fab737","#fbb537","#fbb336","#fcb035","#fcae34","#fdab33","#fda932","#fda631","#fda330","#fea12f","#fe9e2e","#fe9b2d","#fe982c","#fd952b","#fd9229","#fd8f28","#fd8c27","#fc8926","#fc8624","#fb8323","#fb8022","#fa7d20","#fa7a1f","#f9771e","#f8741c","#f7711b","#f76e1a","#f66b18","#f56817","#f46516","#f36315","#f26014","#f15d13","#ef5a11","#ee5810","#ed550f","#ec520e","#ea500d","#e94d0d","#e84b0c","#e6490b","#e5460a","#e3440a","#e24209","#e04008","#de3e08","#dd3c07","#db3a07","#d93806","#d73606","#d63405","#d43205","#d23005","#d02f04","#ce2d04","#cb2b03","#c92903","#c72803","#c52602","#c32402","#c02302","#be2102","#bb1f01","#b91e01","#b61c01","#b41b01","#b11901","#ae1801","#ac1601","#a91501","#a61401","#a31201","#a01101","#9d1001","#9a0e01","#970d01","#940c01","#910b01","#8e0a01","#8b0901","#870801","#840701","#810602","#7d0502","#7a0402"]}}}}},"nonselection_glyph":{"type":"object","name":"MultiLine","id":"p3936","attributes":{"xs":{"type":"field","field":"xs"},"ys":{"type":"field","field":"ys"},"line_color":{"type":"field","field":"z","transform":{"id":"p3931"}},"line_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"MultiLine","id":"p3937","attributes":{"xs":{"type":"field","field":"xs"},"ys":{"type":"field","field":"ys"},"line_color":{"type":"field","field":"z","transform":{"id":"p3931"}},"line_alpha":{"type":"value","value":0.2}}}}},{"id":"p3949"},{"type":"object","name":"GlyphRenderer","id":"p3963","attributes":{"data_source":{"id":"p3953"},"view":{"type":"object","name":"CDSView","id":"p3964","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p3965"}}},"glyph":{"type":"object","name":"Scatter","id":"p3960","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":{"type":"value","value":"#1f77b4"},"line_alpha":{"type":"value","value":0},"fill_color":{"type":"field","field":"t","transform":{"type":"object","name":"LinearColorMapper","id":"p3956","attributes":{"palette":["#000003","#160B39","#410967","#6A176E","#932567","#BA3655","#DC5039","#F2751A","#FBA40A","#F6D542","#FCFEA4"],"low":0}}},"fill_alpha":{"type":"value","value":0.5}}},"nonselection_glyph":{"type":"object","name":"Scatter","id":"p3961","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":{"type":"value","value":"#1f77b4"},"line_alpha":{"type":"value","value":0.1},"fill_color":{"type":"field","field":"t","transform":{"id":"p3956"}},"fill_alpha":{"type":"value","value":0.1},"hatch_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"Scatter","id":"p3962","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":{"type":"value","value":"#1f77b4"},"line_alpha":{"type":"value","value":0.2},"fill_color":{"type":"field","field":"t","transform":{"id":"p3956"}},"fill_alpha":{"type":"value","value":0.2},"hatch_alpha":{"type":"value","value":0.2}}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p3851","attributes":{"tools":[{"type":"object","name":"PanTool","id":"p3866"},{"type":"object","name":"WheelZoomTool","id":"p3867","attributes":{"renderers":"auto"}},{"type":"object","name":"BoxZoomTool","id":"p3868","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p3869","attributes":{"syncable":false,"level":"overlay","visible":false,"left":{"type":"number","value":"nan"},"right":{"type":"number","value":"nan"},"top":{"type":"number","value":"nan"},"bottom":{"type":"number","value":"nan"},"left_units":"canvas","right_units":"canvas","top_units":"canvas","bottom_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"SaveTool","id":"p3874"},{"type":"object","name":"ResetTool","id":"p3875"},{"type":"object","name":"HelpTool","id":"p3876"},{"id":"p3952"}],"active_tap":{"id":"p3952"}}},"left":[{"id":"p3861"}],"right":[{"type":"object","name":"ColorBar","id":"p3941","attributes":{"title":"Drawdown (m)","title_text_color":"#17648D","title_text_font":"arial","title_text_font_size":"18px","title_text_font_style":"bold","major_label_policy":{"type":"object","name":"NoOverlap","id":"p3942"},"major_label_text_font":"arial","major_label_text_font_size":"15px","major_label_text_font_style":"normal","color_mapper":{"id":"p3931"}}}],"below":[{"id":"p3856"},{"type":"object","name":"ColorBar","id":"p3966","attributes":{"orientation":"horizontal","title":"Particle Travel Time (years)","title_text_color":"#17648D","title_text_font":"arial","title_text_font_size":"18px","title_text_font_style":"bold","major_label_policy":{"type":"object","name":"NoOverlap","id":"p3967"},"major_label_text_font":"arial","major_label_text_font_size":"15px","major_label_text_font_style":"normal","color_mapper":{"id":"p3956"}}}],"center":[{"type":"object","name":"Grid","id":"p3860","attributes":{"axis":{"id":"p3856"}}},{"type":"object","name":"Grid","id":"p3865","attributes":{"dimension":1,"axis":{"id":"p3861"}}},{"type":"object","name":"Arrow","id":"p3878","attributes":{"source":{"type":"object","name":"ColumnDataSource","id":"p3880","attributes":{"selected":{"type":"object","name":"Selection","id":"p3881","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p3882"},"data":{"type":"map"}}},"x_start":{"type":"value","value":100},"y_start":{"type":"value","value":600},"start_units":"screen","x_end":{"type":"value","value":200},"y_end":{"type":"value","value":600},"end_units":"screen","end":{"type":"object","name":"VeeHead","id":"p3877","attributes":{"size":{"type":"value","value":15}}}}},{"type":"object","name":"Label","id":"p3883","attributes":{"text":"Regional Gradient\\nDirection","text_font":"arial","text_font_size":"15px","text_font_style":"bold","x":100,"y":600,"x_units":"screen","y_units":"screen","y_offset":-50}},{"type":"object","name":"Legend","id":"p3893","attributes":{"title_text_font":"arial","title_text_font_size":"18px","title_text_font_style":"bold","label_text_color":"#17648D","label_text_font":"arial","label_text_font_size":"15px","items":[{"type":"object","name":"LegendItem","id":"p3894","attributes":{"label":{"type":"value","value":"Pumping well"},"renderers":[{"id":"p3890"}]}},{"type":"object","name":"LegendItem","id":"p3907","attributes":{"label":{"type":"value","value":"Well capture zone"},"renderers":[{"id":"p3904"}]}}]}},{"type":"object","name":"Arrow","id":"p3911","attributes":{"source":{"type":"object","name":"ColumnDataSource","id":"p3908","attributes":{"selected":{"type":"object","name":"Selection","id":"p3909","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p3910"},"data":{"type":"map","entries":[["x0",[]],["y0",[]],["x1",[]],["y1",[]]]}}},"x_start":{"type":"field","field":"x0"},"y_start":{"type":"field","field":"y0"},"start":{"id":"p3877"},"x_end":{"type":"field","field":"x1"},"y_end":{"type":"field","field":"y1"},"end":{"id":"p3877"}}},{"type":"object","name":"Label","id":"p3916","attributes":{"visible":false,"text":"Max Width = ","text_font":"arial","text_font_size":"15px","text_font_style":"bold","x":0,"y":0}},{"type":"object","name":"Arrow","id":"p3921","attributes":{"source":{"type":"object","name":"ColumnDataSource","id":"p3918","attributes":{"selected":{"type":"object","name":"Selection","id":"p3919","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p3920"},"data":{"type":"map","entries":[["x0",[]],["y0",[]],["x1",[]],["y1",[]]]}}},"x_start":{"type":"field","field":"x0"},"y_start":{"type":"field","field":"y0"},"start":{"type":"object","name":"VeeHead","id":"p3917","attributes":{"size":{"type":"value","value":5}}},"x_end":{"type":"field","field":"x1"},"y_end":{"type":"field","field":"y1"},"end":{"id":"p3917"}}},{"type":"object","name":"Label","id":"p3926","attributes":{"visible":false,"text":"Culm. Pt. = ","text_font":"arial","text_font_size":"15px","text_font_style":"bold","x":0,"y":0}}],"match_aspect":true}}],["w_src",{"id":"p3908"}],["w_lbl",{"id":"p3916"}],["c_src",{"id":"p3918"}],["c_lbl",{"id":"p3926"}],["hr_src",{"id":"p3928"}],["color_bar",{"id":"p3941"}],["rb",{"type":"object","name":"RadioButtonGroup","id":"p3927","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:active",[{"id":"p3969"}]]]},"stylesheets":[{"id":"p3835"}],"labels":["Well Drawdown","Hydraulic Head"],"active":0}}],["pt_cb",{"id":"p3968"}]]},"code":"import * as d3 from \\"https://cdn.jsdelivr.net/npm/d3@7.9/+esm\\"\\nimport * as d3Contour from &#x27;https://cdn.jsdelivr.net/npm/d3-contour@4.0.2/+esm&#x27;\\n\\n// js function equivalent to np.linspace\\nfunction makeArr(startValue, stopValue, cardinality) {\\n  var arr = [];\\n  var step = (stopValue - startValue) / (cardinality - 1);\\n  for (var i = 0; i &lt; cardinality; i++) {\\n\\tarr.push(startValue + (step * i));\\n  }\\n  return arr;\\n}\\n\\n//given bnds {xmin: , xmax: , ymin: , ymax: }, Xdim = number of columns, Ydim number of rows\\n// returns an array of coordinate objects in a grid  \\nfunction genGridPts(bnds,Xdim,Ydim){\\n  var xa = makeArr(bnds.xmin,bnds.xmax,Xdim)\\n  var ya = makeArr(bnds.ymin,bnds.ymax,Ydim)\\n  var cx = d3.cross(ya,xa).map(v=&gt;{return {&#x27;x&#x27;:v[1],&#x27;y&#x27;:v[0]}})\\n  return cx\\n    }\\n    \\n//transforms columndatasource data to array of objects\\nfunction cds_to_objarray(cds_data){\\n  var keys = Object.keys(cds_data)\\n  var z = d3.transpose(Object.values(cds_data))\\n  var o = z.map(x=&gt;Object.assign(...keys.map((k, i) =&gt; ({[k]: x[i]}))))\\n  return o}\\n  \\n//transforms array of objects to columndatasource \\"dictionary\\"/object \\nfunction objarray_to_cds(objarray){\\n  var a = d3.transpose(objarray.map(x=&gt;Object.values(x)))\\n  if (a.length&gt;0){\\n    var d = Object.assign(...Object.keys(objarray[0]).map((k, i) =&gt; ({[k]: a[i]})))\\n    }\\n  return d\\n  }\\n  \\n//translates a d3 contour result into multiline-ready CDS data\\nfunction contours_to_cds(d3_contour){\\n    var cxs = []\\n    var cys = []\\n    var cv = []\\n    for (var vi=0;vi&lt;d3_contour.length;vi++){                       \\n     \\t\\t   for (var pi=0; pi&lt;d3_contour[vi].coordinates.length;pi++){\\n     \\t\\t\\t  for (var ppi = 0; ppi&lt;d3_contour[vi].coordinates[pi].length;ppi++){                                  \\n     \\t\\t\\t\\t\\t  var xy = d3.transpose(d3_contour[vi].coordinates[pi][ppi])\\n     \\t\\t\\t\\t\\t  cxs.push(xy[0])\\n     \\t\\t\\t\\t\\t  cys.push(xy[1])\\n     \\t\\t\\t\\t\\t  cv.push(d3_contour[vi].value)\\n     \\t\\t\\t\\t\\t  }\\n     \\t\\t\\t\\t\\t  }\\n     \\t\\t\\t\\t   }\\n    return {&#x27;z&#x27;:cv,&#x27;xs&#x27;:cxs,&#x27;ys&#x27;:cys}\\n    }\\n\\nfunction arrayCenteredOnPt(bnds,n,ptX){\\n    var step = (bnds[1] - bnds[0] )/ (n - 1);\\n       //step forward\\n       var f = []\\n       var i = 0\\n       do {\\n       \\tvar xn = ptX+i*step\\n        f.push(xn)\\n        i++\\n       \\t} while (xn&lt;bnds[1])\\n       //step backward\\n       var b = []\\n       var i = 1\\n       do {\\n       \\tvar xn = ptX+i*-step\\n        b.push(xn)\\n        i++\\n       \\t} while (xn&gt;bnds[0])\\n    b.reverse()\\n    return b.concat(f)\\n    \\t}\\n\\nexport default function({src,sl_dict,f,w_src,w_lbl,c_src,c_lbl\\n                        ,hr_src,color_bar,rb,pt_cb\\n                        }){\\n\\t//collect slider values\\n\\tvar q = sl_dict[&#x27;Pumping&#x27;].value/10**9 //cubic km/s \\n\\tvar k = 10**sl_dict[&#x27;Conductivity&#x27;].value/1000 //km/s\\n\\tvar i = 10**sl_dict[&#x27;Gradient&#x27;].value\\n\\tvar b = sl_dict[&#x27;Thickness&#x27;].value/1000 //km\\n\\n\\t//get ymax and x0_conf\\n\\tvar ymax = q/(2*k*i*b)\\n\\tvar x0 = q/(2*Math.PI*k*i*b)\\n\\n\\t//calculate array for y based on ymax\\n\\tvar ya = makeArr(-ymax*0.999,ymax*0.999, 1000)\\n\\t//calculate array for x based on ya\\n\\tvar xa = ya.map(y=&gt;y/(Math.tan(2*Math.PI*k*i*b*y/q))) //convert m to km\\n\\n\\t//update src\\n\\tsrc.data = {&#x27;x&#x27;:xa, &#x27;y&#x27;:ya}\\n\\tsrc.change.emit()\\n\\t//calculate figure bounds\\n\\t//hard set x range based on x0.\\n\\tvar sbs = [0.25,1,5,25,50,100].map(x=&gt;x/25) // \\n\\t\\n\\tfor (var ib = 0; ib &lt; sbs.length; ib++){\\n    \\tif (x0&lt;sbs[ib]){\\n        \\tvar x0v = sbs[ib]\\n        \\tbreak\\n        \\t}\\n    \\t}\\n    if (ib==sbs.length){\\n        var x0v = x0\\n        }\\n\\tvar xr = [x0v*-25,x0v*1.1]\\n\\t\\n\\tf.x_range.start = xr[0]\\n\\tf.x_range.end = xr[1]\\n\\t//aspect ratio\\n\\tvar ar = f.inner_height/f.inner_width\\n    var r = xr[1]-xr[0]\\n    f.y_range.start = -r/2*ar\\n    f.y_range.end = r/2*ar\\n\\n\\t\\n\\t//calculate max width\\n\\tvar w = q/(k*i*b)\\n\\t\\n\\t//update max width annotation\\n\\tw_src.data={&#x27;x0&#x27;:[x0*-22],&#x27;x1&#x27;:[x0*-22],&#x27;y0&#x27;:[-w/2], &#x27;y1&#x27;:[w/2]}\\n    w_lbl.visible = true\\n    w_lbl.text = &#x27;Max Width = &#x27;+w.toFixed(2).toString()+&#x27; km&#x27;\\n    w_lbl.x = x0*-21.25\\n    \\n    //update culm pt annotation\\n    c_src.data={&#x27;x0&#x27;:[0],&#x27;x1&#x27;:[x0],&#x27;y0&#x27;:[0], &#x27;y1&#x27;:[0]}\\n    c_lbl.visible = true\\n    c_lbl.text = &#x27;X\\u2080 =\\\\n&#x27;+x0.toFixed(2).toString()+&#x27; km&#x27;\\n    c_lbl.x = -x0*1.7\\n    c_lbl.y = w*0.05\\n    \\n    //build and evaluation grid for drawdown\\n    var xr = f.x_range.end-f.x_range.start\\n    var yr = f.y_range.end-f.y_range.start\\n    var bnds = {&#x27;xmin&#x27;:f.x_range.start-xr*0.5,&#x27;xmax&#x27;:f.x_range.end+xr*0.5\\n        ,&#x27;ymin&#x27;:f.y_range.start-yr*0.5,&#x27;ymax&#x27;:f.y_range.end+yr*0.5}\\n    var nx  = 200\\n    var ny = 200\\n\\n\\n    function calcH(x,y,i,q,b,k){\\n        var rgt = -i*(x-1000) \\n        var wt = q/(2*Math.PI*b*k)*Math.log((x**2+y**2)**0.5/1000)\\n        return {&#x27;rgt&#x27;:rgt,&#x27;wt&#x27;:wt, &#x27;h&#x27;:rgt+wt}\\n        }\\n        \\n    //calc head at well\\n    var hwell = calcH(1e-20,1e-20,i,q,b,k)\\n    hwell = hwell[&#x27;h&#x27;]*1000\\n\\n    //get arrays for grid --&gt; centered on .01,.01 (reasonable distance)\\n    var xa = arrayCenteredOnPt([bnds[&#x27;xmin&#x27;],bnds[&#x27;xmax&#x27;]],nx,0)\\n    var ya = arrayCenteredOnPt([bnds[&#x27;ymin&#x27;],bnds[&#x27;ymax&#x27;]],ny,0)\\n\\n    var grd = []\\n\\n    for (var yi = 0; yi &lt; ya.length; yi++){\\n        for (var xi = 0; xi &lt; xa.length; xi++){\\n            var h = calcH(xa[xi],ya[yi],i,q,b,k)\\n            var obj = {&#x27;x&#x27;:xa[xi],&#x27;y&#x27;:ya[yi],&#x27;wt&#x27;:h[&#x27;wt&#x27;]*1000,&#x27;h&#x27;:h[&#x27;h&#x27;]*1000-hwell}\\n            grd.push(obj)\\n            }\\n        }\\n\\n    var ctr = d3Contour.contours().thresholds(25).size([xa.length,ya.length])\\n    //var ctr = d3Contour.contours().thresholds(25).size([nx,ny])\\n    if (rb.active==0){\\n        var contours = contours_to_cds(ctr(grd.map(x=&gt;x.wt)))\\n        color_bar.title = &#x27;Drawdown Contours (m)&#x27;\\n        }\\n    else {\\n        var contours = contours_to_cds(ctr(grd.map(x=&gt;x.h)))\\n        color_bar.title = &#x27;Hydraulic Head Contours (m, relative to well)&#x27;\\n        }\\n    \\n    //back to coords\\n    contours[&#x27;xs&#x27;] = contours[&#x27;xs&#x27;].map(x=&gt;x.map(xx=&gt;xx/xa.length*(xa[xa.length-1]-xa[0])+xa[0]))\\n    contours[&#x27;ys&#x27;] = contours[&#x27;ys&#x27;].map(y=&gt;y.map(yy=&gt;yy/ya.length*(ya[ya.length-1]-ya[0])+ya[0]))\\n    hr_src.data=contours  \\n    pt_cb.execute()        \\t\\n}","module":true}},{"type":"object","name":"CustomJS","id":"p3972","attributes":{"args":{"type":"map","entries":[["ccb",{"type":"object","name":"CustomJS","id":"p3971","attributes":{"args":{"type":"map","entries":[["ni",{"type":"object","name":"NumericInput","id":"p3970","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p3972"}]]]},"width":100,"value":0,"low":0,"high":0.2,"mode":"float"}}],["sl",{"id":"p3836"}],["log",false]]},"code":"\\n                    sl.tags=[]\\n                    ni.tags=[]\\n                                        \\n                    if (cb_obj === sl){\\n                            if (log == true){\\n                                 ni.value = 10**sl.value\\n                                    }\\n                            else {\\n                                ni.value = sl.value\\n                                }\\n                            }\\n                    else {\\n                        // if ni, need to find nearest slider value\\n                        if (log == true){\\n                                var v = Math.log10(ni.value)\\n                                }\\n                        else {\\n                            var v = ni.value\\n                            }\\n                        //value input is less than slider start\\n                        if (v&lt;=sl.start){\\n                                if (log == true){\\n                                     sl.value = sl.start\\n                                     ni.value = 10**sl.start\\n                                        }\\n                                else {\\n                                    sl.value = sl.start\\n                                    ni.value = sl.start\\n                                    }\\n                                }\\n                        //value is more than slider end\\n                        else if (v&gt;=sl.end){\\n                                if (log == true){\\n                                     sl.value = sl.end\\n                                     ni.value = 10**sl.end\\n                                        }\\n                                else {\\n                                    sl.value = sl.end\\n                                    ni.value = sl.end\\n                                    }\\n                            }\\n                        \\n                        else {\\n                            var i = 1\\n                            do {\\n                                if (v&lt;sl.start+sl.step*i){\\n                                        //value is now between current notch and previous\\n                                        if (log==true){\\n                                            var dl = Math.log10(ni.value)-(sl.start+sl.step*(i-1))\\n                                            var dr = (sl.start+(sl.step*i))-Math.log(ni.value)\\n                                            }\\n                                        else {\\n                                            var dl = ni.value-(sl.start+sl.step*(i-1))\\n                                            var dr = (sl.start+(sl.step*i))-ni.value\\n                                            }\\n                                        if (dl&lt;=dr){\\n                                                var v = sl.start+sl.step*(i-1)\\n                                                }\\n                                        else {\\n                                            var v = sl.start+sl.step*i\\n                                            }\\n                                        sl.value = v\\n                                        if (log==true){\\n                                                ni.value = 10**v\\n                                                }\\n                                        else {\\n                                            ni.value = v\\n                                            }\\n                                        break\\n                                        }\\n                                i++\\n                                } while (true)\\n                            }\\n                        }\\n                    "}}],["sl",{"id":"p3836"}],["ni",{"id":"p3970"}]]},"code":"\\n\\n                  if (cb_obj.tags.length&gt;0){\\n                          return\\n                          }\\n                  else {\\n                      sl.tags = [&#x27;run_me&#x27;]\\n                      ni.tags = [&#x27;run_me&#x27;]\\n                      ccb.execute(cb_obj)\\n                      sl.tags = [&#x27;run_me&#x27;]\\n                      ni.tags = [&#x27;run_me&#x27;]\\n                      }\\n                  "}}]]]},"stylesheets":[{"id":"p3835"}],"width":1200,"sizing_mode":"stretch_width","title":"Pumping rate (m\\u00b3/s)","format":"0.000","start":0,"end":0.2,"value":0,"step":0.001}},{"id":"p3970"}]}},{"type":"object","name":"Row","id":"p3986","attributes":{"sizing_mode":"scale_width","children":[{"id":"p3837"},{"id":"p3973"}]}},{"type":"object","name":"Row","id":"p3987","attributes":{"sizing_mode":"scale_width","children":[{"id":"p3839"},{"id":"p3976"}]}},{"type":"object","name":"Row","id":"p3988","attributes":{"sizing_mode":"scale_width","children":[{"id":"p3841"},{"id":"p3979"}]}},{"type":"object","name":"Row","id":"p3989","attributes":{"sizing_mode":"scale_width","children":[{"id":"p3842"},{"id":"p3982"}]}},{"id":"p3927"},{"id":"p3843"}]}}]}}';
        const render_items = [{"docid":"95c5ad28-2141-4989-a75a-298eaedc7b26","roots":{"p3990":"b06ae59a-fe0c-40b0-9f74-347e00bd0839"},"root_ids":["p3990"]}];
        root.Bokeh.embed.embed_items(docs_json, render_items);
        }
        if (root.Bokeh !== undefined) {
          embed_document(root);
        } else {
          let attempts = 0;
          const timer = setInterval(function(root) {
            if (root.Bokeh !== undefined) {
              clearInterval(timer);
              embed_document(root);
            } else {
              attempts++;
              if (attempts > 100) {
                clearInterval(timer);
                console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
              }
            }
          }, 10, root)
        }
      })(window);
    });
  };
  if (document.readyState != "loading") fn();
  else document.addEventListener("DOMContentLoaded", fn);
})();
    </script>

            </head>
            <body>
                <div>
                <div id="b06ae59a-fe0c-40b0-9f74-347e00bd0839" data-root-id="p3990" style="display: contents;"></div>
                </div>
            </body>
        </html>
        